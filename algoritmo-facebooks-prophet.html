<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 Algoritmo Facebook´s Prophet | Distribución de cartera por producto</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="12 Algoritmo Facebook´s Prophet | Distribución de cartera por producto" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 Algoritmo Facebook´s Prophet | Distribución de cartera por producto" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Angie Cantillo, Carlos Casallas Ciprian, Ginna Quintero Afanador" />


<meta name="date" content="2024-05-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="implementación-modelo-arima.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="base-de-datos.html"><a href="base-de-datos.html"><i class="fa fa-check"></i><b>1</b> Base de datos</a></li>
<li class="chapter" data-level="2" data-path="información-y-justificación.html"><a href="información-y-justificación.html"><i class="fa fa-check"></i><b>2</b> Información y justificación</a></li>
<li class="chapter" data-level="3" data-path="instalación-de-paquetes-y-carga-de-datos.html"><a href="instalación-de-paquetes-y-carga-de-datos.html"><i class="fa fa-check"></i><b>3</b> Instalación de paquetes y carga de datos</a></li>
<li class="chapter" data-level="4" data-path="analisis-exploratorio-de-datos.html"><a href="analisis-exploratorio-de-datos.html"><i class="fa fa-check"></i><b>4</b> Analisis exploratorio de datos</a></li>
<li class="chapter" data-level="5" data-path="variables-de-tiempo.html"><a href="variables-de-tiempo.html"><i class="fa fa-check"></i><b>5</b> Variables de tiempo</a></li>
<li class="chapter" data-level="6" data-path="descomposición-de-la-serie-de-tiempo.html"><a href="descomposición-de-la-serie-de-tiempo.html"><i class="fa fa-check"></i><b>6</b> Descomposición de la serie de tiempo</a>
<ul>
<li class="chapter" data-level="6.1" data-path="descomposición-de-la-serie-de-tiempo.html"><a href="descomposición-de-la-serie-de-tiempo.html#tendencia"><i class="fa fa-check"></i><b>6.1</b> Tendencia</a></li>
<li class="chapter" data-level="6.2" data-path="descomposición-de-la-serie-de-tiempo.html"><a href="descomposición-de-la-serie-de-tiempo.html#estacionalidad"><i class="fa fa-check"></i><b>6.2</b> Estacionalidad</a></li>
<li class="chapter" data-level="6.3" data-path="descomposición-de-la-serie-de-tiempo.html"><a href="descomposición-de-la-serie-de-tiempo.html#residuos"><i class="fa fa-check"></i><b>6.3</b> Residuos</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="estacionariedad.html"><a href="estacionariedad.html"><i class="fa fa-check"></i><b>7</b> Estacionariedad</a></li>
<li class="chapter" data-level="8" data-path="diferenciación.html"><a href="diferenciación.html"><i class="fa fa-check"></i><b>8</b> Diferenciación</a></li>
<li class="chapter" data-level="9" data-path="modelo-holt-winters.html"><a href="modelo-holt-winters.html"><i class="fa fa-check"></i><b>9</b> Modelo Holt-Winters</a></li>
<li class="chapter" data-level="10" data-path="suavizamiento-exponencial-simple.html"><a href="suavizamiento-exponencial-simple.html"><i class="fa fa-check"></i><b>10</b> Suavizamiento Exponencial Simple</a></li>
<li class="chapter" data-level="11" data-path="implementación-modelo-arima.html"><a href="implementación-modelo-arima.html"><i class="fa fa-check"></i><b>11</b> Implementación modelo ARIMA</a></li>
<li class="chapter" data-level="12" data-path="algoritmo-facebooks-prophet.html"><a href="algoritmo-facebooks-prophet.html"><i class="fa fa-check"></i><b>12</b> Algoritmo Facebook´s Prophet</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Distribución de cartera por producto</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="algoritmo-facebooks-prophet" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">12</span> Algoritmo Facebook´s Prophet<a href="algoritmo-facebooks-prophet.html#algoritmo-facebooks-prophet" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="algoritmo-facebooks-prophet.html#cb67-1" tabindex="-1"></a><span class="co">#Instalar y cargar las bibliotecas necesarias</span></span>
<span id="cb67-2"><a href="algoritmo-facebooks-prophet.html#cb67-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;prophet&#39;</span>)</span></code></pre></div>
<pre><code>## package &#39;prophet&#39; successfully unpacked and MD5 sums checked
## 
## The downloaded binary packages are in
##  D:\Usuarios\dir.tic\AppData\Local\Temp\RtmpaML7Qg\downloaded_packages</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="algoritmo-facebooks-prophet.html#cb69-1" tabindex="-1"></a><span class="fu">library</span>(prophet)</span>
<span id="cb69-2"><a href="algoritmo-facebooks-prophet.html#cb69-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="algoritmo-facebooks-prophet.html#cb70-1" tabindex="-1"></a>data_agrupada <span class="ot">&lt;-</span> data_agrupada <span class="sc">%&gt;%</span></span>
<span id="cb70-2"><a href="algoritmo-facebooks-prophet.html#cb70-2" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ds =</span> FECHA_CORTE, <span class="at">y =</span> Vigente)</span>
<span id="cb70-3"><a href="algoritmo-facebooks-prophet.html#cb70-3" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">prophet</span>(data_agrupada)</span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="algoritmo-facebooks-prophet.html#cb71-1" tabindex="-1"></a><span class="co"># Crear un data frame con fechas futuras</span></span>
<span id="cb71-2"><a href="algoritmo-facebooks-prophet.html#cb71-2" tabindex="-1"></a>future <span class="ot">&lt;-</span> <span class="fu">make_future_dataframe</span>(model, <span class="at">periods =</span> <span class="dv">365</span>)</span>
<span id="cb71-3"><a href="algoritmo-facebooks-prophet.html#cb71-3" tabindex="-1"></a></span>
<span id="cb71-4"><a href="algoritmo-facebooks-prophet.html#cb71-4" tabindex="-1"></a><span class="co"># Hacer las predicciones</span></span>
<span id="cb71-5"><a href="algoritmo-facebooks-prophet.html#cb71-5" tabindex="-1"></a>forecast <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, future)</span>
<span id="cb71-6"><a href="algoritmo-facebooks-prophet.html#cb71-6" tabindex="-1"></a></span>
<span id="cb71-7"><a href="algoritmo-facebooks-prophet.html#cb71-7" tabindex="-1"></a><span class="co"># Mostrar las predicciones</span></span>
<span id="cb71-8"><a href="algoritmo-facebooks-prophet.html#cb71-8" tabindex="-1"></a><span class="fu">tail</span>(forecast[, <span class="fu">c</span>(<span class="st">&#39;ds&#39;</span>, <span class="st">&#39;yhat&#39;</span>, <span class="st">&#39;yhat_lower&#39;</span>, <span class="st">&#39;yhat_upper&#39;</span>)])</span></code></pre></div>
<pre><code>##             ds         yhat   yhat_lower   yhat_upper
## 470 2025-02-23 9.727443e+14 9.560862e+14 9.891513e+14
## 471 2025-02-24 9.649326e+14 9.466726e+14 9.805899e+14
## 472 2025-02-25 9.561289e+14 9.381406e+14 9.735787e+14
## 473 2025-02-26 9.464692e+14 9.302673e+14 9.627711e+14
## 474 2025-02-27 9.361103e+14 9.192101e+14 9.513544e+14
## 475 2025-02-28 9.252262e+14 9.078968e+14 9.420562e+14</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="algoritmo-facebooks-prophet.html#cb73-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb73-2"><a href="algoritmo-facebooks-prophet.html#cb73-2" tabindex="-1"></a>actual_sales_2023 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">365</span>, <span class="at">lambda =</span> <span class="dv">210</span>)</span>
<span id="cb73-3"><a href="algoritmo-facebooks-prophet.html#cb73-3" tabindex="-1"></a>actual_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ds =</span> <span class="fu">seq</span>(<span class="fu">as.Date</span>(<span class="st">&#39;2023-01-01&#39;</span>), <span class="fu">as.Date</span>(<span class="st">&#39;2023-12-31&#39;</span>), <span class="at">by =</span> <span class="st">&#39;day&#39;</span>), <span class="at">y =</span> actual_sales_2023)</span>
<span id="cb73-4"><a href="algoritmo-facebooks-prophet.html#cb73-4" tabindex="-1"></a></span>
<span id="cb73-5"><a href="algoritmo-facebooks-prophet.html#cb73-5" tabindex="-1"></a><span class="co"># Unir las predicciones con los datos reales</span></span>
<span id="cb73-6"><a href="algoritmo-facebooks-prophet.html#cb73-6" tabindex="-1"></a>comparison_df <span class="ot">&lt;-</span> <span class="fu">merge</span>(forecast[, <span class="fu">c</span>(<span class="st">&#39;ds&#39;</span>, <span class="st">&#39;yhat&#39;</span>)], actual_df, <span class="at">by =</span> <span class="st">&#39;ds&#39;</span>)</span>
<span id="cb73-7"><a href="algoritmo-facebooks-prophet.html#cb73-7" tabindex="-1"></a></span>
<span id="cb73-8"><a href="algoritmo-facebooks-prophet.html#cb73-8" tabindex="-1"></a><span class="co"># Calcular el error</span></span>
<span id="cb73-9"><a href="algoritmo-facebooks-prophet.html#cb73-9" tabindex="-1"></a>comparison_df <span class="ot">&lt;-</span> comparison_df <span class="sc">%&gt;%</span></span>
<span id="cb73-10"><a href="algoritmo-facebooks-prophet.html#cb73-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error =</span> y <span class="sc">-</span> yhat, <span class="at">abs_error =</span> <span class="fu">abs</span>(error))</span>
<span id="cb73-11"><a href="algoritmo-facebooks-prophet.html#cb73-11" tabindex="-1"></a></span>
<span id="cb73-12"><a href="algoritmo-facebooks-prophet.html#cb73-12" tabindex="-1"></a>mae <span class="ot">&lt;-</span> <span class="fu">mean</span>(comparison_df<span class="sc">$</span>abs_error)</span>
<span id="cb73-13"><a href="algoritmo-facebooks-prophet.html#cb73-13" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&#39;Mean Absolute Error (MAE):&#39;</span>, mae))</span></code></pre></div>
<pre><code>## [1] &quot;Mean Absolute Error (MAE): NaN&quot;</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="algoritmo-facebooks-prophet.html#cb75-1" tabindex="-1"></a><span class="co"># Graficar el modelo y las predicciones</span></span>
<span id="cb75-2"><a href="algoritmo-facebooks-prophet.html#cb75-2" tabindex="-1"></a><span class="fu">plot</span>(model, forecast) <span class="sc">+</span></span>
<span id="cb75-3"><a href="algoritmo-facebooks-prophet.html#cb75-3" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Predicciones con Prophet&quot;</span>) <span class="sc">+</span></span>
<span id="cb75-4"><a href="algoritmo-facebooks-prophet.html#cb75-4" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Fecha&quot;</span>) <span class="sc">+</span></span>
<span id="cb75-5"><a href="algoritmo-facebooks-prophet.html#cb75-5" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Valor&quot;</span>)</span></code></pre></div>
<p><img src="Series_de_tiempo_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>En estos gráficos podemos ver:</p>
<ul>
<li><p>Línea azul: Representa los valores reales del capital vigente en mora a lo largo del tiempo.</p></li>
<li><p>Banda gris: Representa el intervalo de predicción del modelo Prophet Facebook. La banda gris indica el rango dentro del cual se espera que se encuentre el valor real con una cierta probabilidad (generalmente 95%).</p></li>
<li><p>Línea punteada azul: Representa la predicción puntual del modelo Prophet Facebook para el capital vigente en mora. Es decir, el valor que el modelo predice como el más probable para cada punto en el tiempo.</p></li>
</ul>
<p>En general, el modelo Prophet Facebook parece ajustarse bien a los datos históricos del capital vigente en mora. La banda de predicción abarca los valores reales de la serie, lo que indica que el modelo es capaz de capturar la variabilidad de la serie.</p>
<p>Sin embargo, es importante tener en cuenta que las predicciones son solo estimaciones y no son completamente precisas. El valor real del capital vigente en mora podría estar fuera de la banda de predicción, incluso con una probabilidad del 5%.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="algoritmo-facebooks-prophet.html#cb76-1" tabindex="-1"></a><span class="co"># Graficar los componentes del modelo (tendencia y estacionalidad)</span></span>
<span id="cb76-2"><a href="algoritmo-facebooks-prophet.html#cb76-2" tabindex="-1"></a><span class="fu">prophet_plot_components</span>(model, forecast)</span></code></pre></div>
<p><img src="Series_de_tiempo_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>Sobre los componentes del modelo se evidencia una combinación de una tendencia ascendente con una estacionalidad clara, con disminuciones al final de cada trimestre, lo que puede indicar un aumento en los pagos que genera un acto reflejo en la disminución del capital Vigente en mora.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="implementación-modelo-arima.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
